
用户
=========

与用户相关的文件
----------
用户账户
```sh
/etc/passwd
#每一行代表一个账号，有几行就代表有几个账号在系统中。
#有些账号是系统自带的系统账号，不要随意删除。如：bin,daemon,adm,nobody等。

# 格式：
ll /etc/passwd
adm:x:3:4:adm:/var/adm:/sbin/nologin

# 格式说明
# 列1：账号名称
# 列2：密码，早期UNIX系统的密码就放在该位置。但因这个文件的特性是所有的程序都可以读取，容易造成密码被窃取。后来就将密码放到/etc/shadow中了。
# 列3：UID  0 系统管理员 1~499 系统账号  500~65535 可登录账号
# 列4：GID
# 列5：用户信息说明
# 列6：用户主文件夹，也叫用户家目录。默认用户主目录为/home/用户名，也可更改此列指定到其它位置。root的家目录特殊，是/root。
# 列7：Shell。用户登录后，会取得一个Shell来与系统的内核通信以进行用户的操作任务。就是这里指定的。特例：有一个shell可以用来替代让账号无法取得shell环境，就是/sbin/nologin。 
```




用户密码
```sh
/etc/shadow

# 格式：
ll /etc/shadow


# 格式说明
# 列1：账号名称
# 列2：加密后的密码
# 列3：最近改动密码的日期
# 列4：密码不可被更改的天数 0 表示不限制，可随时更改
# 列5：密码需要重新被更改的天数。
# 列6：密码需要更改期限前的警告天数
# 列7：密码过期后的账号宽限时间
# 列8：账号失效日期
# 列9：保留列
```


用户与组的关联
```sh
/etc/group

# 格式：
ll /etc/group


# 格式说明
# 列1：用户组名称
# 列2：用户组密码，通常不需要设置。
# 列3：GID
# 列4：此用户组中的账号名称。注意，一个组下可以有多个账号，一个账号可以加入多个组(第一个组为有效用户组)。
```


创建用户
---------
直接用 useradd 用户名 回车即可，此时系统默认做了许多事。
- 在/etc/passwd 里面创建一行与账号相关的数据；
- 在/etc/shadow 里面将此账号的密码相关参数填入，但是尚未有密码；
- 在/etc/group 里面加一个与账号名称一样的组名；
- 在/home下创建一个与账号同名的目录做为用户家目录，权限为700。

```sh
useradd [-u UID] [-g 初始用户组] [-G 次要用户组] [-mM]\
 [-c 用户说明] [-d 用户家目录] [-s shell] 用户名


#查看useradd的默认值
useradd -D

#查看当前用户的组
groups
#输出的第一个组为有效用户组

#切换当前用户的有效用户组
newgrp 组名
#切换后，再次查看
```

更改密码
----------
```sh
#更改当前用户的密码
passwd

#更改指定用户的密码
passwd 用户名
```


删除用户
----------
userdel同useradd相反，系统帮我们做了以下事情
- 删除用户相关数据 /etc/passwd /etc/shadow
- 删除用户组相关数据 /etc/group /etc/gshadow
- 删除用户个人文件数据 /home/用户名 /var/spool/mail/用户名 ...

```sh
userdel 用户名
userdel -r 用户名
#-r 连同用户的家目录一起删除
```

注意：一般慎用这个命令。要删除某个用户，咱们手动更改/etc/passwd即可



用户组
=========

```sh
#添加组
groupadd 组名

#删除组
groupdel 组名
```


用户身份切换
=========
su
```sh

#切换到root
su

#切换到指定用户
su 用户名

#切换到指定用户，并切换到目标用户的家目录
su - 用户名
```

sudo
```sh
#以root身份执行相关命令
sudo 待执行的命令

#以指定的身份执行相关命令
sudo -u 用户名 待执行的命令
```



ACL
===========
```sh
getfacl

setfacl
```



查询用户
============
```sh
#查看当前系统中登录的用户有哪些用 w 或 who
w
who

# 查看每个账号的最近登录时间用lastlog，它其实是去读取/var/log/lastlog文件。
lastlog
```








